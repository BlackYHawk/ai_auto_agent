# Feature Specification: 添加Egui桌面UI界面

**Feature Branch**: `001-egui-ui`
**Created**: 2026-02-15
**Status**: Draft
**Input**: User description: "基于egui框架创建界面，把当前支持的功能使用UI的方式呈现"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 通过UI创建新项目 (Priority: P1)

用户通过图形界面创建新的小说项目，设置项目名称、类型和目标字数。

**Why this priority**: 这是最基础的功能，用户使用系统的入口，必须优先实现。

**Independent Test**: 用户可以通过UI填写表单并成功创建项目，项目信息保存到本地存储。

**Acceptance Scenarios**:

1. **Given** 用户打开应用程序, **When** 用户填写项目名称"我的小说"、类型"玄幻"、目标字数"1000000", **Then** 系统创建项目并显示项目列表
2. **Given** 用户打开应用程序, **When** 用户未填写项目名称就点击创建, **Then** 系统显示错误提示"请输入项目名称"

---

### User Story 2 - 通过UI运行可行性分析 (Priority: P2)

用户选择现有项目，通过UI触发可行性分析功能。

**Why this priority**: 可行性分析是创作前的重要步骤，帮助用户了解选定类型的创作难度。

**Independent Test**: 用户选择项目并点击分析按钮，系统显示分析结果。

**Acceptance Scenarios**:

1. **Given** 用户有一个已创建的项目, **When** 用户选择"玄幻"类型并点击分析, **Then** 系统显示可行性分析报告，包括市场热度、竞争程度等指标
2. **Given** 用户未选择项目, **When** 用户点击分析按钮, **Then** 系统提示"请先选择一个项目"

---

### User Story 3 - 通过UI生成大纲 (Priority: P2)

用户通过UI输入小说前提和主题，生成小说大纲。

**Why this priority**: 大纲是小说创作的骨架，是生成章节的前提条件。

**Independent Test**: 用户输入前提和主题后，系统生成完整的大纲并展示。

**Acceptance Scenarios**:

1. **Given** 用户有一个已创建的项目, **When** 用户输入前提"一个普通少年的修仙之路"并点击生成大纲, **Then** 系统生成并显示章节大纲列表
2. **Given** 用户未输入前提, **When** 用户点击生成大纲, **Then** 系统提示"请输入小说前提"

---

### User Story 4 - 通过UI生成章节 (Priority: P2)

用户选择已生成大纲的项目，通过UI生成具体章节内容。

**Why this priority**: 章节生成是核心功能，直接产出小说内容。

**Independent Test**: 用户选择章节范围并点击生成，系统显示生成的章节内容。

**Acceptance Scenarios**:

1. **Given** 用户已生成项目大纲, **When** 用户选择章节1-3并点击生成, **Then** 系统生成并显示第1-3章的内容
2. **Given** 用户未生成大纲, **When** 用户点击生成章节, **Then** 系统提示"请先生成大纲"

---

### User Story 5 - 通过UI发布到番茄平台 (Priority: P3)

用户通过UI将生成的小说章节发布到番茄小说网。

**Why this priority**: 发布是变现的最后一环，需要支持整个发布流程。

**Independent Test**: 用户可以完成创建小说、上传章节、提交审核的完整流程。

**Acceptance Scenarios**:

1. **Given** 用户有已生成的章节, **When** 用户点击发布并选择发布范围, **Then** 系统显示发布状态（创建/上传/提交）
2. **Given** 用户未登录番茄账号, **When** 用户点击发布, **Then** 系统提示需要配置番茄平台账号

---

### User Story 6 - 通过UI检查一致性 (Priority: P3)

用户通过UI检查小说内容的一致性。

**Why this priority**: 一致性检查帮助维护小说质量，检测人物、设定矛盾。

**Independent Test**: 用户点击检查按钮，系统显示一致性检查报告。

**Acceptance Scenarios**:

1. **Given** 用户有已生成的章节内容, **When** 用户点击一致性检查, **Then** 系统显示检查报告，列出潜在的不一致问题

---

### User Story 7 - 通过UI查看和管理项目 (Priority: P1)

用户通过UI查看所有项目列表，选择项目进行操作。

**Why this priority**: 项目管理是所有其他功能的前提，用户需要能够方便地管理多个项目。

**Independent Test**: 用户可以查看项目列表，选择项目，查看项目详情。

**Acceptance Scenarios**:

1. **Given** 用户有多个项目, **When** 用户打开应用, **Then** 系统显示所有项目列表，包括项目名称、类型、进度
2. **Given** 用户选择一个项目, **When** 用户点击查看详情, **Then** 系统显示项目的详细信息，包括大纲、章节、进度等

---

### Edge Cases

- 当用户尝试在没有网络连接的情况下执行需要网络的功能（如发布到番茄平台），系统应显示友好的错误提示。
- 当生成过程耗时较长时，系统应显示进度条并允许用户取消操作。
- 当项目数据损坏或丢失时，系统应给出清晰的错误信息并提供恢复建议。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须提供图形用户界面，用户可以通过点击按钮和填写表单完成操作
- **FR-002**: 系统必须显示所有已创建的项目列表，包括项目名称、类型、目标字数、当前字数
- **FR-003**: 用户必须能够通过UI创建新项目，设置项目名称、类型（玄幻、都市、仙侠、历史、 romance、科幻、游戏、恐怖）、目标字数
- **FR-004**: 用户必须能够通过UI运行可行性分析，选择类型并查看分析结果
- **FR-005**: 用户必须能够通过UI生成大纲，输入前提和主题后查看生成的大纲
- **FR-006**: 用户必须能够通过UI生成章节，选择章节范围后查看生成的内容
- **FR-007**: 用户必须能够通过UI发布小说到番茄平台，支持创建、上传、提交审核操作
- **FR-008**: 用户必须能够通过UI检查小说一致性，查看检查报告
- **FR-009**: 系统必须在执行耗时操作时显示进度状态，用户可以取消正在进行的操作
- **FR-010**: 系统必须在操作失败时显示清晰的错误信息

### Key Entities

- **项目 (Project)**: 代表用户创建的小说项目，包含名称、类型、目标字数、当前进度
- **大纲 (Outline)**: 小说的章节结构，包含章节目录和每章简介
- **章节 (Chapter)**: 具体的章节内容，包含标题、正文、状态
- **分析报告 (AnalysisReport)**: 可行性分析或一致性检查的结果

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户可以在3次点击内完成创建新项目的操作
- **SC-002**: 用户可以直观地看到所有项目的状态和进度
- **SC-003**: 每个CLI命令功能都可以通过UI触发并显示结果
- **SC-004**: 用户在进行耗时操作时可以清楚地看到进度
- **SC-005**: 操作失败时，用户可以根据错误提示理解问题所在并尝试解决

## Assumptions

- 用户已经配置好了LLM API密钥（在config.toml中）
- 番茄平台发布功能需要用户配置Cookies才能使用
- 项目数据存储在本地文件系统（与CLI共享同一存储结构）
